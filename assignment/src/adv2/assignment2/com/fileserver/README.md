# κ³Όμ : λ‚λ§μ λ―Έλ‹ μ›κ²© νμΌ νƒμƒ‰κΈ° (DataStream Ver.)

## π― λ©ν‘

-   `ServerSocket`κ³Ό `Socket`μ„ μ΄μ©ν•΄ λ©€ν‹°μ¤λ λ“ TCP μ„λ²„λ¥Ό κµ¬μ¶•ν•  μ μλ‹¤.
-   ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ **`DataStream`**μ„ μ΄μ©ν•΄ μ •ν•΄μ§„ μ•½μ†(λ°”μ΄λ„λ¦¬ ν”„λ΅ν† μ½)μ— λ”°λΌ ν†µμ‹ ν•  μ μλ‹¤.
-   μ„λ²„λ” `Files`μ™€ `Path`λ¥Ό μ‚¬μ©ν•΄ ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­ν• νμΌ μ‹μ¤ν… μ •λ³΄λ¥Ό μ΅°νν•κ³  μ‘λ‹µν•  μ μλ‹¤.
-   `try-with-resources`λ¥Ό ν™μ©ν•΄ λ¨λ“  I/O λ° λ„¤νΈμ›ν¬ λ¦¬μ†μ¤λ¥Ό μ•μ „ν•κ² κ΄€λ¦¬ν•  μ μλ‹¤.
-    λ€μ©λ‰ νμΌ μ „μ†΅ μ‹ λ°μƒν•λ” I/O λ³‘λ© ν„μƒμ„ λ¶„μ„ν•κ³ , λ²„νΌλ§μ„ ν†µν•΄ μ„±λ¥μ„ κ°μ„ ν•  μ μλ‹¤. 
-   `ExecutorService`λ¥Ό ν™μ©ν•μ—¬, λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ™μ‹ μ ‘μ† μƒν™©μ—μ„μ μ„λ²„ μ„±λ¥κ³Ό μ•μ •μ„±μ„ κ²€μ¦ν•  μ μλ‹¤.

---

## β­ μ£Όμ” κ°μ„  μ‚¬ν•­ λ° κ²€μ¦

### 1. λ‹¤μ΄λ΅λ“ μ„±λ¥ 99.9% ν–¥μƒ

-   **λ¬Έμ  μ •μ:** μ΄κΈ° κµ¬ν„ μ‹, 100MB ν¬κΈ°μ νμΌ λ‹¤μ΄λ΅λ“μ— ν‰κ·  **325.4μ΄**κ°€ μ†μ”λμ–΄ μ‚¬μ©μ„±μ΄ ν¬κ² λ–¨μ–΄μ§€λ” λ¬Έμ λ¥Ό λ°κ²¬ν–μµλ‹λ‹¤.
-   **μ›μΈ λ¶„μ„:** 1λ°”μ΄νΈ λ‹¨μ„μ λΉ„ν¨μ¨μ μΈ I/O νΈμ¶μ΄ λ°λ³µλμ–΄ λ„¤νΈμ›ν¬ λ° λ””μ¤ν¬ I/O λ³‘λ© ν„μƒμ΄ λ°μƒν•¨μ„ ν™•μΈν–μµλ‹λ‹¤.
-   **κ°μ„  κ³Όμ •:** 8KB ν¬κΈ°μ λ°”μ΄νΈ λ²„νΌ(`byte[] buffer`)λ¥Ό λ„μ…ν•μ—¬ λ°μ΄ν„°λ¥Ό λ©μ–΄λ¦¬(chunk) λ‹¨μ„λ΅ ν• λ²μ— μ½κ³  μ“°λ” λ°©μ‹μΌλ΅ I/O λ΅μ§μ„ λ¦¬ν©ν† λ§ν–μµλ‹λ‹¤.
-   **κ²°κ³Ό:** λ‹¨μΌ ν΄λΌμ΄μ–ΈνΈ κΈ°μ¤€, ν‰κ·  λ‹¤μ΄λ΅λ“ μ‹κ°„μ„ **0.178μ΄**λ΅ λ‹¨μ¶•μ‹μΌ **μ•½ 99.9%μ μ„±λ¥ ν–¥μƒ**μ„ λ‹¬μ„±ν–μµλ‹λ‹¤.

### 2. **[μ¶”κ°€ κ²€μ¦]** λ™μ‹ μ ‘μ† λ¶€ν• ν…μ¤νΈ

-   **κ²€μ¦ λ©ν‘:** λ‹¨μΌ μ„±λ¥ κ°μ„ μ„ λ„μ–΄, μ‹¤μ  μ„λΉ„μ¤ ν™κ²½κ³Ό μ μ‚¬ν• **λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ™μ‹ μ ‘μ† μƒν™©**μ—μ„λ„ μ„λ²„κ°€ μ•μ •μ μΌλ΅ μ„±λ¥μ„ μ μ§€ν•λ”μ§€ κ²€μ¦ν•κ³ μ ν–μµλ‹λ‹¤.
-   **ν…μ¤νΈ λ°©λ²•:** Javaμ `ExecutorService`(μ¤λ λ“ ν’€)λ¥Ό μ΄μ©ν•μ—¬, **10λ…μ ν΄λΌμ΄μ–ΈνΈκ°€ λ™μ‹μ— 100MB νμΌμ„ λ‹¤μ΄λ΅λ“**ν•λ” λ¶€ν• ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤.
-   **ν…μ¤νΈ κ²°κ³Ό:** μ„λ²„λ” **μ¤λ¥ μ—†μ΄ λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ„±κ³µμ μΌλ΅ μ²λ¦¬**ν–μΌλ©°, 10κ°μ νμΌμ„ λ¨λ‘ λ‹¤μ΄λ΅λ“ν•λ” λ° 0.66μ΄(μΈ΅μ •κ°’ μ…λ ¥)μ μ΄ μ†μ” μ‹κ°„μ„ κΈ°λ΅ν–μµλ‹λ‹¤.
-   **κ²°λ΅ :** μ΄λ” 'ν΄λΌμ΄μ–ΈνΈ-μ¤λ λ“ 1:1 λ¨λΈ'μ΄ λ‹¤μ¤‘ μ”μ²­μ„ **ν¨κ³Όμ μΌλ΅ λ³‘λ ¬ μ²λ¦¬**ν•κ³  μμμ„ μ¦λ…ν•λ©°, κ°μ„ λ I/O λ΅μ§μ΄ **λ™μ‹ λ¶€ν• μƒν™©μ—μ„λ„ μ•μ •μ μΈ μ„±λ¥**μ„ λ³΄μ¥ν•λ‹¤λ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.

### 3. ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ΄μ©ν• μµμΆ… λ¦¬ν©ν† λ§

-   **κ°μ„  κ³Όμ •:** λ¶€ν• ν…μ¤νΈ μ΄ν›„, μ§μ ‘ κµ¬ν„ν–λ `byte[]` λ²„νΌ λ΅μ§μ„ Javaμ ν‘μ¤€ I/O λΌμ΄λΈλ¬λ¦¬μΈ **`BufferedInputStream`** λ° **`BufferedOutputStream`**μ„ μ‚¬μ©ν•λ” λ°©μ‹μΌλ΅ μµμΆ… λ¦¬ν©ν† λ§.
-   **λ‹¬μ„± λ©ν‘:** μ§μ ‘μ μΈ μ„±λ¥ ν–¥μƒλ³΄λ‹¤λ”, λ³µμ΅ν• `while` λ£¨ν”„ λ΅μ§μ„ ν‘μ¤€ API νΈμ¶λ΅ λ€μ²΄ν•¨μΌλ΅μ¨ **μ½”λ“μ λ³µμ΅λ„λ¥Ό λ‚®μ¶”κ³  κ°€λ…μ„±κ³Ό μ μ§€λ³΄μμ„±μ„ ν–¥μƒ**μ‹ν‚΄. Java ν‘μ¤€ APIλ¥Ό ν¨κ³Όμ μΌλ΅ ν™μ©ν•λ” λ¥λ ¥μ„ μ²΄λ“. 
-   **ν…μ¤νΈ κ²°κ³Ό:** λ¦¬ν©ν† λ§ ν›„ λ™μΌν• λ¶€ν• ν…μ¤νΈλ¥Ό λ‹¤μ‹ μν–‰ν• κ²°κ³Ό, κ° μ‘μ—…μ ν‰κ·  μ†μ” μ‹κ°„μ΄ **0.535μ΄**λ΅ **μ•½ 20% μ¶”κ°€ λ‹¨μ¶•**λλ” ν¨κ³Όλ¥Ό ν™•μΈν–μµλ‹λ‹¤.
-   **κ²°λ΅ :** μ΄λ¥Ό ν†µν•΄ Java ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬μ μµμ ν™”λ λ‚΄λ¶€ κµ¬ν„μ΄ λ‹¤μ¤‘ μ¤λ λ“ ν™κ²½μ μμ› κ²½ν•© μƒν™©μ—μ„ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μ„μ„ μ¦λ…ν–μµλ‹λ‹¤.
---

## π“ κΈ°λ¥ μ”κµ¬ μ‚¬ν•­

### [κ³µν†µ] ν†µμ‹  κ·μ•½ (Binary Protocol) μ •μ

ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” `DataInputStream`κ³Ό `DataOutputStream`μ„ ν†µν•΄ μ•½μ†λ μμ„λ€λ΅ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›μµλ‹λ‹¤.

-   **ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„ μ”μ²­ ν•μ‹:**
    1.  `command` (`String`): `writeUTF()`λ΅ μ „μ†΅. (`LIST` λλ” `VIEW`)
    2.  `path` (`String`): `writeUTF()`λ΅ μ „μ†΅. (μ: `.`, `src/main`, `README.md`)

-   **μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ μ‘λ‹µ ν•μ‹:**
    1.  `status` (`boolean`): `writeBoolean()`μΌλ΅ μ „μ†΅. (μ„±κ³µ μ‹ `true`, μ‹¤ν¨ μ‹ `false`)
    2.  **μ„±κ³µ μ‹ (`status`κ°€ `true`):**
        -   `LIST` λ…λ Ήμ— λ€ν• μ‘λ‹µ:
            1.  λ©λ΅ κ°μ (`int`): `writeInt()`λ΅ μ „μ†΅.
            2.  λ©λ΅ λ‚΄μ© (`String`): κ°μλ§νΌ `writeUTF()`λ΅ λ°λ³µ μ „μ†΅. (μ: `[D] src`)
        -   `VIEW` λ…λ Ήμ— λ€ν• μ‘λ‹µ:
            1.  νμΌ λ‚΄μ© (`String`): `writeUTF()`λ΅ μ „μ†΅.
        -   `DOWNLOAD` λ…λ Ήμ— λ€ν• μ‘λ‹µ:
            1. νμΌ ν¬κΈ° (`long`): `writeLong()` μΌλ΅ μ „μ†΅.
            2. νμΌ λ‚΄μ© (`byte[]`): νμΌ λκΉμ§€ λ°”μ΄νΈ μ¤νΈλ¦Ό(raw byte stream) μ „μ†΅.
    3.  **μ‹¤ν¨ μ‹ (`status`κ°€ `false`):**
        -   μ—λ¬ λ©”μ‹μ§€ (`String`): `writeUTF()`λ΅ μ „μ†΅.

### [μ„λ²„] `FileServer.java`

-   μ§€μ •λ ν¬νΈμ—μ„ ν΄λΌμ΄μ–ΈνΈμ μ—°κ²°μ„ λ¬΄ν•μ • κΈ°λ‹¤λ¦½λ‹λ‹¤.
-   μƒλ΅μ΄ ν΄λΌμ΄μ–ΈνΈκ°€ μ ‘μ†ν•λ©΄, **λ³„λ„μ μ¤λ λ“λ¥Ό μƒμ„±**ν•μ—¬ ν•΄λ‹Ή ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ μ „λ‹΄ μ²λ¦¬ν•©λ‹λ‹¤.
-   **ν΄λΌμ΄μ–ΈνΈ μ²λ¦¬ λ΅μ§ (μƒ μ¤λ λ“μ—μ„ μν–‰):**
    1.  ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° `command`μ™€ `path`λ¥Ό μμ„λ€λ΅ μ½μµλ‹λ‹¤.
    2.  `command`κ°€ `LIST`μ΄λ©΄:
        -   `Files.list()`λ¥Ό μ‚¬μ©ν•΄ λ””λ ‰ν† λ¦¬ λ‚΄μ©μ„ μ΅°νν•κ³ , μ„±κ³µ μ—¬λ¶€(`true`), λ©λ΅ κ°μ(`int`), λ©λ΅ λ‚΄μ©(`String`...)μ„ μμ„λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.
    3.  `command`κ°€ `VIEW`μ΄λ©΄:
        -   `Files.readString()`μ„ μ‚¬μ©ν•΄ νμΌ λ‚΄μ©μ„ μ½κ³ , μ„±κ³µ μ—¬λ¶€(`true`), νμΌ λ‚΄μ©(`String`)μ„ μμ„λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.
    4.  `command` κ°€ `DOWNLOAD`μ΄λ©΄ `Files.newInputStream()`κ³Ό λ²„νΌλ¥Ό μ‚¬μ©ν•΄ νμΌμ λ°”μ΄νΈ μ¤νΈλ¦Όμ„ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.
    5.  μμ™Έ λ°μƒ μ‹, μ‹¤ν¨ μ—¬λ¶€(`false`)μ™€ μ—λ¬ λ©”μ‹μ§€(`String`)λ¥Ό μμ„λ€λ΅ ν΄λΌμ΄μ–ΈνΈμ— μ „μ†΅ν•©λ‹λ‹¤.

### [ν΄λΌμ΄μ–ΈνΈ] `FileClient.java`

-   μ‚¬μ©μλ΅λ¶€ν„° μ½μ†” μ…λ ¥μ„ λ°›λ” λ¬΄ν• λ£¨ν”„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
-   μ‚¬μ©μ μ…λ ¥μ„ λ¶„μ„ν•μ—¬ μ„λ²„μ— λ³΄λ‚Ό `command`μ™€ `path`λ¥Ό κ²°μ •ν•©λ‹λ‹¤.
-   μ„λ²„μ— μ ‘μ†(`Socket`)ν•μ—¬ `command`μ™€ `path`λ¥Ό μμ„λ€λ΅ μ „μ†΅ν•©λ‹λ‹¤.
-   μ„λ²„μ μ‘λ‹µμ„ **μ•½μ†λ μμ„λ€λ΅** μ½μµλ‹λ‹¤.
    1.  κ°€μ¥ λ¨Όμ € `status`(`boolean`)λ¥Ό μ½μµλ‹λ‹¤.
    2.  `status`κ°€ `true`μ΄λ©΄, μ„±κ³µ λ°μ΄ν„°λ¥Ό μ•½μ†λ μμ„(κ°μ β†’ λ‚΄μ©)λ€λ΅ μ½μ–΄ μ¶λ ¥ν•©λ‹λ‹¤.
    3.  `status`κ°€ `false`μ΄λ©΄, μ—λ¬ λ©”μ‹μ§€λ¥Ό μ½μ–΄ μ¶λ ¥ν•©λ‹λ‹¤.

---

## π€ μ‹¤ν–‰ μμ‹ (ν΄λΌμ΄μ–ΈνΈ μ½μ†”)

λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ” (μ: ls <κ²½λ΅>, view <νμΌλ…>, download <νμΌλ…>):

ls .
[D] .git
[D] .idea
[F] .gitignore
[F] README.md

λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ” (μ: ls <κ²½λ΅>, view <νμΌλ…>, download <νμΌλ…>):

download test.zip
test.zip νμΌ λ‹¤μ΄λ΅λ“ μ‹μ‘...
104857600 λ°”μ΄νΈ νμΌ λ‹¤μ΄λ΅λ“ μ™„λ£. (μ†μ” μ‹κ°„: 1.4μ΄)

λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ” (μ: ls <κ²½λ΅>, view <νμΌλ…>, download <νμΌλ…>):

view README.md

λ―Έλ‹ μ›κ²© νμΌ νƒμƒ‰κΈ°
μ΄κ²ƒμ€ κ³Όμ μ© ν”„λ΅μ νΈμ…λ‹λ‹¤.

λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ” (μ: ls <κ²½λ΅>, view <νμΌλ…>, download <νμΌλ…>):

ls non-existent-folder
[ERROR] κ²½λ΅λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤: non-existent-folder

λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•μ„Έμ” (μ: ls <κ²½λ΅>, view <νμΌλ…>, download <νμΌλ…>):

exit
ν΄λΌμ΄μ–ΈνΈλ¥Ό μΆ…λ£ν•©λ‹λ‹¤.

---

## π’΅ ννΈ λ° λ„μ „ κ³Όμ 

-   **ν”„λ΅ν† μ½ ννΈ:** μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² μ—¬λ¬ κ°μ λ°μ΄ν„°(μ: νμΌ λ©λ΅)λ¥Ό λ³΄λ‚Ό λ•λ”, **μ‹¤μ  λ°μ΄ν„°λ¥Ό λ³΄λ‚΄κΈ° μ „μ— λ¨Όμ € λ°μ΄ν„°μ κ°μλ¥Ό
- `writeInt()`λ΅ λ³΄λ‚΄μ£Όλ” κ²ƒ**μ΄ μΌλ°μ μ΄κ³  μ•μ •μ μΈ λ°©λ²•μ…λ‹λ‹¤.
-   **λ„μ „ κ³Όμ :** `DOWNLOAD <κ²½λ΅>` λ…λ Ήμ–΄λ¥Ό μ¶”κ°€ν•΄λ³΄μ„Έμ”. `Files.readString()` λ€μ‹  `Files.newInputStream()`μΌλ΅ νμΌμ
- **λ°”μ΄νΈ μ¤νΈλ¦Ό**μ„ μ½κ³ , μ†μΌ“μ `OutputStream`μΌλ΅ ν΄λΌμ΄μ–ΈνΈμ— κ·Έλ€λ΅ μ „μ†΅ν•λ” κΈ°λ¥μ„ κµ¬ν„ν•΄λ³΄μ„Έμ”. 
- ν΄λΌμ΄μ–ΈνΈλ” μ†μΌ“μ `InputStream`μΌλ΅ λ°”μ΄νΈ λ°μ΄ν„°λ¥Ό λ°›μ•„ `Files.write()`λ΅ νμΌμ— μ €μ¥ν•΄μ•Ό ν•©λ‹λ‹¤.